apiVersion: bgp.purelb.io/v1
kind: BGPConfiguration
metadata:
  name: bgp-config-with-auth
  namespace: k8gobgp-system
spec:
  global:
    asn: 64512
    routerID: "192.168.1.1"
    listenPort: 179
    families:
      - "ipv4-unicast"

  neighbors:
    - config:
        neighborAddress: "192.168.1.254"
        peerAsn: 64513
        description: "Authenticated peer"
        # Reference to Secret for BGP MD5 authentication
        # The Secret should contain a key matching the neighbor address or "password"
        authPasswordSecretRef:
          name: bgp-auth-secrets
          key: "192.168.1.254"
      afiSafis:
        - family: "ipv4-unicast"
          enabled: true
      timers:
        config:
          holdTime: 90
          keepaliveInterval: 30

---
# Example Secret for BGP authentication passwords
# IMPORTANT: In production, create this Secret separately and securely
apiVersion: v1
kind: Secret
metadata:
  name: bgp-auth-secrets
  namespace: k8gobgp-system
type: Opaque
stringData:
  # Key is the neighbor address, value is the MD5 password
  "192.168.1.254": "secret-bgp-password"
  # You can also use a default key
  password: "default-password"
